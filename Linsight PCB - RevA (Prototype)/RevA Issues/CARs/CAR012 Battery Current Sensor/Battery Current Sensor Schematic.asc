Version 4
SHEET 1 1864 1124
WIRE 944 -400 768 -400
WIRE 1168 -400 1008 -400
WIRE 768 -288 768 -400
WIRE 928 -288 768 -288
WIRE 1168 -288 1168 -400
WIRE 1168 -288 1008 -288
WIRE -320 -224 -368 -224
WIRE -208 -224 -240 -224
WIRE -208 -176 -208 -224
WIRE 768 -176 768 -288
WIRE 928 -176 768 -176
WIRE 1168 -176 1168 -288
WIRE 1168 -176 1008 -176
WIRE 304 -96 304 -128
WIRE 304 -96 192 -96
WIRE 192 -80 192 -96
WIRE 304 -80 304 -96
WIRE -64 -64 -64 -112
WIRE 0 -64 -64 -64
WIRE 0 -48 0 -64
WIRE 944 -48 944 -64
WIRE 1040 -48 944 -48
WIRE 1040 -16 1040 -48
WIRE 192 16 192 -16
WIRE 304 16 304 0
WIRE 304 16 192 16
WIRE 0 32 0 16
WIRE 304 48 304 16
WIRE 1040 80 1040 48
WIRE -64 112 -64 -64
WIRE 944 112 944 -48
WIRE 768 160 768 -176
WIRE 912 160 768 160
WIRE 1168 192 1168 -176
WIRE 1168 192 1056 192
WIRE 160 224 -64 224
WIRE 208 224 160 224
WIRE 384 224 208 224
WIRE 464 224 384 224
WIRE 592 224 544 224
WIRE 720 224 592 224
WIRE 912 224 720 224
WIRE -64 272 -64 224
WIRE 1040 272 992 272
WIRE 208 288 208 224
WIRE 384 288 384 224
WIRE 944 288 944 272
WIRE 592 496 592 224
WIRE 720 496 720 224
WIRE -64 528 -64 352
WIRE 592 608 592 576
WIRE 720 608 720 560
WIRE 64 624 64 592
WIRE 64 768 64 704
WIRE 128 768 64 768
WIRE 208 768 208 368
WIRE 208 768 128 768
WIRE 384 768 384 352
WIRE 208 784 208 768
WIRE 272 784 208 784
WIRE 64 816 64 768
WIRE 208 816 208 784
WIRE 272 896 272 784
WIRE 384 896 272 896
WIRE 64 928 64 880
WIRE 208 928 208 880
FLAG 64 928 0
FLAG 64 592 VCC
FLAG 304 -128 VCC
FLAG 304 48 0
FLAG -64 528 0
FLAG 944 -64 VCC
FLAG 592 608 0
FLAG 1040 272 VCC
FLAG 944 288 0
FLAG 208 928 0
FLAG 1168 192 VOUT
FLAG 720 608 0
FLAG 128 768 Vref
FLAG 384 768 0
FLAG 1040 80 0
FLAG -64 -112 12V
FLAG -208 -176 0
FLAG -368 -224 GNDboard
FLAG 0 32 0
FLAG 160 224 Vsensor
SYMBOL res 192 272 R0
SYMATTR InstName R1
SYMATTR Value 500
SYMBOL res 80 608 M0
SYMATTR InstName R2
SYMATTR Value 400
SYMBOL voltage 304 -96 R0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL current -64 352 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 -28 Left 2
WINDOW 123 24 -56 Left 2
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value SINE(0 5m 100 0 0 0 2)
SYMATTR Value2 AC 1
SYMBOL res 1024 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res 560 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL Opamps\\LTC2050HV 944 192 R0
SYMATTR InstName U1
SYMBOL res 576 480 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL References\\LT1004-2.5 64 848 M0
SYMATTR InstName U2
SYMBOL cap 224 816 M0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL cap 704 496 R0
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL cap 1008 -416 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 1n
SYMBOL cap 368 288 R0
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL res 1024 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL cap 1024 -16 R0
SYMATTR InstName C5
SYMATTR Value 100n
SYMBOL res -224 -240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 0
SYMBOL cap 176 -80 R0
SYMATTR InstName C6
SYMATTR Value 100n
SYMBOL cap -16 -48 R0
SYMATTR InstName C7
SYMATTR Value 1µ
TEXT -536 256 Left 2 ;Essentially a current source that\noutputs 25 uA/A.  This equates\nto -5 mA to 5 mA output current\ngiven -200 A to 200 A input current.
TEXT 604 714 Left 2 !.tran 10m
TEXT 608 832 Left 2 !;ac dec 100m 1 10Meg
TEXT 768 536 Left 2 ;C0G
TEXT 904 -424 Left 2 ;C0G
TEXT 496 288 Left 2 ;1%
TEXT 528 536 Left 2 ;1%
TEXT 952 -232 Left 2 ;1%
TEXT 648 176 Left 2 ;OPAMP needs to support\n"Rail-to-rail" operation
TEXT -584 728 Left 2 ;Vref will change slightly as current sunk into\nzener changes (due to battery current sensor).\nHowever, this won't matter because it will also\nchange the reference voltage the ADC sees,\nwhich will make any Vref deviations linear.\nHowever, this will make current values at\neither extreme (e.g. -200 or 200 A) slightly \nless accurate.  If you want 100% linear\noperation across all current values, then\nbuffer Vref with an opamp.
TEXT -304 584 Left 2 ;This value needs to be low\nenough that current always\nflows through zener diode.\n(400 Ohms is low enough).
TEXT -544 96 Left 2 ;OEM battery current sensor
TEXT -232 -144 Left 2 ;local\nground
TEXT -352 -320 Left 2 ;Not actually\na resistor
TEXT -368 -448 Left 2 ;G1 Honda Insight battery current sensor unipolar amplifier circuit, by 'mudder' (a.k.a 'John Sullivan').\nThis work is licensed under a Creative Commons Attribution 4.0 International License.
TEXT -528 -192 Left 2 ;Connect near\nuC analog ground
TEXT 384 896 Left 2 ;To uC reference pin
TEXT 784 344 Left 2 ;200 A through current sensor = 2.5 V output\n-200 A through current sensor = 0.0 V output\n000 A through current sensor = VREF/2 output
RECTANGLE Normal 96 480 -560 112 2
